<div class="card shadow-lg border-0 rounded-4">
  <div class="card-header bg-primary text-white rounded-top-4 d-flex align-items-center">
    <i class="fas fa-user-plus me-2"></i>
    <h5 class="mb-0">Add New User</h5>
  </div>

  <div class="card-body">
    <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>

      <!-- Full Name -->
      <div class="mb-3">
        <label class="form-label fw-semibold">Full Name</label>
        <input type="text"
               class="form-control rounded-pill px-3"
               formControlName="fullName"
               placeholder="Enter full name"
               [ngClass]="{'is-invalid': hasDisplayError('fullName')}">
        <div class="invalid-feedback" *ngIf="hasDisplayError('fullName')">
          <div *ngIf="form.get('fullName')?.errors?.['required']">Full name is required.</div>
          <div *ngIf="form.get('fullName')?.errors?.['minlength']">Must have at least 3 characters.</div>
        </div>
      </div>

      <!-- Email -->
      <div class="mb-3">
        <label class="form-label fw-semibold">Email</label>
        <input type="email"
               class="form-control rounded-pill px-3"
               formControlName="email"
               placeholder="Enter email"
               [ngClass]="{'is-invalid': hasDisplayError('email')}">
        <div class="invalid-feedback" *ngIf="hasDisplayError('email')">
          <div *ngIf="form.get('email')?.errors?.['required']">Email is required.</div>
          <div *ngIf="form.get('email')?.errors?.['email']">Please enter a valid email.</div>
          <div *ngIf="form.get('email')?.errors?.['pattern']">Must be a gmail.com address.</div>
        </div>
      </div>

      <!-- Role -->
      <div class="mb-3">
        <label class="form-label fw-semibold">Role</label>
        <select class="form-select rounded-pill px-3"
                formControlName="role"
                [ngClass]="{'is-invalid': hasDisplayError('role')}">
          <option value="" disabled>Select role</option>
          <option *ngFor="let role of roles" [value]="role.roleId">{{ role.roleName }}</option>
        </select>
        <div class="invalid-feedback" *ngIf="hasDisplayError('role')">
          Please select a role.
        </div>
      </div>

      <!-- Shop -->
      <div class="mb-3">
        <label class="form-label fw-semibold">Shop</label>
        <select class="form-select rounded-pill px-3"
                formControlName="shop"
                [ngClass]="{'is-invalid': hasDisplayError('shop')}">
          <option value="" disabled>Select shop</option>
          <option *ngFor="let shop of shops" [value]="shop.shopId">{{ shop.shopName }}</option>
        </select>
        <div class="invalid-feedback" *ngIf="hasDisplayError('shop')">
          Please select a shop.
        </div>
      </div>

      <!-- Password -->
      <div class="mb-3">
        <label class="form-label fw-semibold">Password</label>
        <input type="password"
               class="form-control rounded-pill px-3"
               formControlName="password"
               placeholder="Enter password"
               [ngClass]="{'is-invalid': hasDisplayError('password')}">
        <div class="invalid-feedback" *ngIf="hasDisplayError('password')">
          <div *ngIf="form.get('password')?.errors?.['required']">Password is required.</div>
          <div *ngIf="form.get('password')?.errors?.['minlength']">At least 6 characters required.</div>
          <div *ngIf="form.get('password')?.errors?.['maxlength']">Maximum 12 characters allowed.</div>
          <div *ngIf="form.get('password')?.errors?.['pattern']">Must contain a special character.</div>
        </div>
      </div>

      <!-- Confirm Password -->
      <div class="mb-3">
        <label class="form-label fw-semibold">Confirm Password</label>
        <input type="password"
               class="form-control rounded-pill px-3"
               formControlName="confirmPassword"
               placeholder="Confirm password"
               [ngClass]="{'is-invalid': hasDisplayError('confirmPassword') || form.errors?.['passwordMismatch']}">
        <div class="invalid-feedback" *ngIf="hasDisplayError('confirmPassword') || form.errors?.['passwordMismatch']">
          <div *ngIf="form.get('confirmPassword')?.errors?.['required']">Please confirm your password.</div>
          <div *ngIf="form.errors?.['passwordMismatch']">Passwords do not match.</div>
        </div>
      </div>

      <!-- Buttons -->
      <div class="d-flex justify-content-end mt-4">
        <button type="submit"
                class="btn btn-primary px-4 rounded-pill"
                [disabled]="form.invalid || isLoading">
          <i class="fas fa-save me-1"></i>
          {{ isLoading ? 'Creating...' : 'Add User' }}
        </button>
      </div>
    </form>
  </div>
</div>
